いままでの作成いただいたスクリプトで下記テーブルを作成しています。


player_info テーブル
ii,date,Race_Number,Class,Gender,Age,Win_Rate,Place_Rate,fst_Place_Count,snd_Place_Count,Start_Count,Top_Finish_Count,First_Place_Count,Average_Start_Timing, 
Lane_1_Entry_Count,Lane_1_Place_Rate,Lane_1_Average_Start_Timing,Lane_1_Average_Start_Position,Lane_2_Entry_Count,Lane_2_Place_Rate,Lane_2_Average_Start_Timing,Lane_2_Average_Start_Position,
Lane_3_Entry_Count,Lane_3_Place_Rate,Lane_3_Average_Start_Timing,Lane_3_Average_Start_Position,Lane_4_Entry_Count,Lane_4_Place_Rate,Lane_4_Average_Start_Timing,Lane_4_Average_Start_Position,
Lane_5_Entry_Count,Lane_5_Place_Rate,Lane_5_Average_Start_Timing,Lane_5_Average_Start_Position,Lane_6_Entry_Count,Lane_6_Place_Rate,Lane_6_Average_Start_Timing,Lane_6_Average_Start_Position,
Previous_Class,Previous_Previous_Class,Previous_Previous_Previous_Class,Previous_Class_Ability_Index,Current_Class_Ability_Index,
Lane_1_First_Place_Count,Lane_1_Second_Place_Count,Lane_1_Third_Place_Count,Lane_1_Fourth_Place_Count,Lane_1_Fifth_Place_Count,Lane_1_Sixth_Place_Count,Lane_1_Fall_Count,Lane_1_Lost_by_0_Lengths_Count,
Lane_1_Lost_by_1_Length_Count,Lane_1_Kept_Lead_by_0_Lengths_Count,Lane_1_Kept_Lead_by_1_Length_Count,Lane_1_Surged_by_0_Lengths_Count,Lane_1_Surged_by_1_Length_Count,Lane_1_Surged_by_2_Lengths_Count,
Lane_2_First_Place_Count,Lane_2_Second_Place_Count,Lane_2_Third_Place_Count,Lane_2_Fourth_Place_Count,Lane_2_Fifth_Place_Count,Lane_2_Sixth_Place_Count,Lane_2_Fall_Count,Lane_2_Lost_by_0_Lengths_Count,
Lane_2_Lost_by_1_Length_Count,Lane_2_Kept_Lead_by_0_Lengths_Count,Lane_2_Kept_Lead_by_1_Length_Count,Lane_2_Surged_by_0_Lengths_Count,Lane_2_Surged_by_1_Length_Count,Lane_2_Surged_by_2_Lengths_Count,
Lane_3_First_Place_Count,Lane_3_Second_Place_Count,Lane_3_Third_Place_Count,Lane_3_Fourth_Place_Count,Lane_3_Fifth_Place_Count,Lane_3_Sixth_Place_Count,Lane_3_Fall_Count,Lane_3_Lost_by_0_Lengths_Count,
Lane_3_Lost_by_1_Length_Count,Lane_3_Kept_Lead_by_0_Lengths_Count,Lane_3_Kept_Lead_by_1_Length_Count,Lane_3_Surged_by_0_Lengths_Count,Lane_3_Surged_by_1_Length_Count,Lane_3_Surged_by_2_Lengths_Count,
Lane_4_First_Place_Count,Lane_4_Second_Place_Count,Lane_4_Third_Place_Count,Lane_4_Fourth_Place_Count,Lane_4_Fifth_Place_Count,Lane_4_Sixth_Place_Count,Lane_4_Fall_Count,Lane_4_Lost_by_0_Lengths_Count,
Lane_4_Lost_by_1_Length_Count,Lane_4_Kept_Lead_by_0_Lengths_Count,Lane_4_Kept_Lead_by_1_Length_Count,Lane_4_Surged_by_0_Lengths_Count,Lane_4_Surged_by_1_Length_Count,Lane_4_Surged_by_2_Lengths_Count,
Lane_5_First_Place_Count,Lane_5_Second_Place_Count,Lane_5_Third_Place_Count,Lane_5_Fourth_Place_Count,Lane_5_Fifth_Place_Count,Lane_5_Sixth_Place_Count,Lane_5_Fall_Count,Lane_5_Lost_by_0_Lengths_Count,
Lane_5_Lost_by_1_Length_Count,Lane_5_Kept_Lead_by_0_Lengths_Count,Lane_5_Kept_Lead_by_1_Length_Count,Lane_5_Surged_by_0_Lengths_Count,Lane_5_Surged_by_1_Length_Count,Lane_5_Surged_by_2_Lengths_Count,
Lane_6_First_Place_Count,Lane_6_Second_Place_Count,Lane_6_Third_Place_Count,Lane_6_Fourth_Place_Count,Lane_6_Fifth_Place_Count,Lane_6_Sixth_Place_Count,Lane_6_Fall_Count,Lane_6_Lost_by_0_Lengths_Count,
Lane_6_Lost_by_1_Length_Count,Lane_6_Kept_Lead_by_0_Lengths_Count,Lane_6_Kept_Lead_by_1_Length_Count,Lane_6_Surged_by_0_Lengths_Count,Lane_6_Surged_by_1_Length_Count,Lane_6_Surged_by_2_Lengths_Count



rece_result テーブル
number, date, location, 
race_number, trifecta_payout, weather, wind_direction, wind_speed, wave_height, 
first_place_horse_number, second_place_horse_number, third_place_horse_number, 
fourth_place_horse_number, fifth_place_horse_number, sixth_place_horse_number




上記テーブルをjoinし、新たなテーブルの作成を検討しています。
新規のテーブルは下記構成を考えています。rece_result テーブルを元に結合予定
テーブル名：analysis_data
number (primary)
date:rece_result
location:rece_result
race_number:rece_result
trifecta_payout:rece_result
weather:rece_result
wind_direction:rece_result
wind_speed:rece_result
wave_height:rece_result
---------------------------------※1
1st_Class:player_info
1st_Gender:player_info
1st_Age:player_info
・・・・・・
1st_Lane_6_Surged_by_1_Length_Count:player_info
1st_Lane_6_Surged_by_2_Lengths_Count:player_info
2st_Class:player_info
2st_Gender:player_info
2st_Age:player_info
・・・・・・
6st_Lane_6_Surged_by_1_Length_Count:player_info
6st_Lane_6_Surged_by_2_Lengths_Count:player_info
---------------------------------
judge(int) (if trifecta_payout>=12000: true=1,flase=0) 新規カラム

※1　player_infoテーブルから情報を取得
6人データを入力するため、6回繰り返す
カラム名に一人目は1st_,二人目は2st_と接頭語を追加　カラム名の重複が無いように
Race_Number(player_info) = first_place_horse_number(rece_result)


なお、Race_Number(player_info)にはテーブル内重複があるため下記ルールにて最新のデータを選択する。
1/1～6/31：player_info テーブルのdateが前年10月のデータで抽出
例：rece_result テーブルのdateが2023/05/02であった場合、前年の10月＝player_info テーブルのdate 2022/10 での該当データが対象
7/1～12/31：player_info テーブルのdateが当年4月のデータで抽出
例：rece_result テーブルのdateが2023/10/02であった場合、当年の4月＝player_info テーブルのdate 2023/4 での該当データが対象


judgeカラムは、新規での追加。trifecta_payoutカラムが12000以上の場合1を追加、12000未満である場合0を入力
